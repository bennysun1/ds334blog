mutate(Team = fct_reorder(Team, AVG), .desc = T) %>%
ggplot(aes(x = Team,
y = AVG,
fill = Division
)) +
geom_boxplot() +
labs(y = "BAA",
title = "BAA Projection by Team") +
#scale_y_continuous(breaks = seq(0, 15, by = 2)) +
#scale_y_continuous(limits = c(0.001, 0.3)) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~Division)
projections %>%
filter(!is.na(Team)) %>%
mutate(Team = fct_reorder(Team, AVG), .desc = T) %>%
ggplot(aes(x = Team,
y = AVG,
fill = Division
)) +
geom_boxplot() +
labs(y = "BAA",
title = "BAA Projection by Team") +
#scale_y_continuous(breaks = seq(0, 15, by = 2)) +
#scale_y_continuous(limits = c(0.001, 0.3)) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~Division, scales = "free_x") +
coord_flip()
projections %>%
filter(!is.na(Team)) %>%
mutate(Team = fct_reorder(Team, AVG), .desc = T) %>%
ggplot(aes(x = Team,
y = AVG,
fill = Division
)) +
geom_boxplot() +
labs(y = "BAA",
title = "BAA Projection by Team") +
#scale_y_continuous(breaks = seq(0, 15, by = 2)) +
#scale_y_continuous(limits = c(0.001, 0.3)) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~Division, scales = "free_y") +
coord_flip()
projections %>%
filter(!is.na(Team)) %>%
mutate(Team = fct_reorder(Team, AVG), .desc = T) %>%
ggplot(aes(x = Team,
y = AVG,
fill = Division
)) +
geom_boxplot() +
labs(y = "BAA",
title = "BAA Projection by Team") +
#scale_y_continuous(breaks = seq(0, 15, by = 2)) +
#scale_y_continuous(limits = c(0.001, 0.3)) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1)) +
facet_wrap(~Division, scales = "free_y") +
coord_flip() +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = avg_baa)) +
geom_histogram(color = "black", "grey40") +
labs(y = "BAA",
title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = avg_baa)) +
geom_histogram(aes(color = "black", "grey40")) +
labs(y = "BAA",
title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = avg_baa)) +
geom_histogram(aes(x = avg_baa, color = "black", "grey40")) +
labs(y = "BAA",
title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(aes(x = AVG, color = "black", "grey40")) +
labs(y = "BAA",
title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram() +
labs(y = "BAA",
title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram() +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "blue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "blue", fill = "red") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_grid(~ Division, scales = "free_x")
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_grid(~ Division)
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division)
theme_minimal()
projections <-
projections %>%
filter(!is.na(Team)) %>%
mutate(Division = case_when(
grepl("(BOS|NYY|TOR|BAL|TB)", Team) ~ "AL EAST",
grepl("(MIN|DET|CLE|CWS|KC)", Team) ~ "AL CENTRAL",
grepl("(HOU|TEX|SEA|LAA|OAK)", Team) ~ "AL WEST",
grepl("(ATL|PHI|MIA|NYM|WSH)", Team) ~ "NL EAST",
grepl("(MIL|CHC|CIN|PIT|STL)", Team) ~ "NL CENTRAL",
grepl("(LAD|ARI|SD|SF|COL)", Team) ~ "NL WEST"
)) %>%
mutate(Division = factor(Division, levels = division_order))
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division)
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG)) +
geom_histogram(color = "black", fill = "lightblue") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.75)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram() +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = "black") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5)) +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = "black") +
labs(title = "Distribution of BAA Projection by Team") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none") +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
projections %>%
#mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = "black") +
labs(title = "Distribution of BAA Projection by Team",
x = "BAA") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "none") +
#coord_flip(ylim = c(0.22,0.26)) +
facet_wrap(~ Division) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
theme(legend.position = "none") +
facet_wrap(~ Division, scales = "free_y") +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = "black") +
labs(y = "Average BAA",
title = "Average BAA") +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = "none") +
facet_wrap(~ Division, scales = "free") +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
projections <- read_csv("/Users/bensunshine/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/FantasyPros_2024_Projections_H.csv")
library(tidyverse)
projections <- read_csv("/Users/bensunshine/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/FantasyPros_2024_Projections_H.csv")
projections %>%
filter(is.na(Team))
nrow(projections)
nrow(projections %>% filter(is.na(Team)))
# histogram of BAAs by division
projections %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = 'black') +
labs(title = 'Distribution of BAA Projection by Team',
x = 'BAA') +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division) +
theme_minimal()
library(tidyverse)
#projections <- read_csv('data/FantasyPros_2024_Projections_H.csv')
projections <- read_csv('/Users/bensunshine/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/FantasyPros_2024_Projections_H.csv')
missing_team <-
projections %>%
filter(is.na(Team))
num_players <- nrow(projections)
division_order <- c('AL EAST', 'AL CENTRAL', 'AL WEST', 'NL EAST', 'NL CENTRAL', 'NL WEST', NA)
projections <-
projections %>%
filter(!is.na(Team)) %>%
mutate(Division = case_when(
grepl('(BOS|NYY|TOR|BAL|TB)', Team) ~ 'AL EAST',
grepl('(MIN|DET|CLE|CWS|KC)', Team) ~ 'AL CENTRAL',
grepl('(HOU|TEX|SEA|LAA|OAK)', Team) ~ 'AL WEST',
grepl('(ATL|PHI|MIA|NYM|WSH)', Team) ~ 'NL EAST',
grepl('(MIL|CHC|CIN|PIT|STL)', Team) ~ 'NL CENTRAL',
grepl('(LAD|ARI|SD|SF|COL)', Team) ~ 'NL WEST'
)) %>%
mutate(Division = factor(Division, levels = division_order))
team_avg_projections <-
projections %>%
group_by(Division, Team) %>%
summarise(num_player = n(),
avg_hr = mean(HR),
avg_baa = mean(AVG),
avg_hits = mean(H),
avg_obp = mean(OBP),
se_baa = sqrt(
((mean(AVG)/n()) * (1-(mean(AVG)/n()))) /
n()
)
) %>%
mutate(Division = factor(Division, levels = division_order),
lb_se_baa = avg_baa - se_baa,
ub_se_baa = avg_baa + se_baa)
# histogram of BAAs by division
projections %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = 'black') +
labs(title = 'Distribution of BAA Projection by Team',
x = 'BAA') +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division) +
theme_minimal()
# error bar plot
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
theme(legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
# bar plot avg BAA
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_x') +
#coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_x') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
# histogram of BAAs by division
projections %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = 'black') +
labs(title = 'Distribution of BAA Projection by Team',
x = 'BAA') +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division) +
theme_minimal()
# error bar plot
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
theme(legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
# bar plot avg BAA
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
# histogram of BAAs by division
projections %>%
ggplot(aes(x = AVG,
fill = Division)) +
geom_histogram(color = 'black') +
labs(title = 'Distribution of BAA Projection by Division',
x = 'BAA') +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division) +
theme_minimal()
# error bar plot
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
theme(legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
# bar plot avg BAA
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_baa,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average BAA',
title = 'Average BAA') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip(ylim = c(0.22,0.26)) +
theme_minimal()
