mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average OPS',
title = 'Average OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.4,0.8)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average OPS',
title = 'Average OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.8)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average OPS',
title = 'Average OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75)) +
theme_minimal()
# histogram of BAAs by division
# projections %>%
#   ggplot(aes(x = AVG,
#              fill = Division)) +
#   geom_histogram(color = 'black') +
#   labs(title = 'Distribution of BAA Projection by Division',
#        x = 'BAA') +
#   theme(plot.title = element_text(hjust = 0.5),
#         legend.position = 'none') +
#   facet_wrap(~ Division) +
#   theme_minimal()
# error bar plot
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
theme(legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
# bar plot avg OPS
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average OPS',
title = 'Average OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
labs(title = "Average BAA by Team",
y = "Average BAA")
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
labs(title = "Average BAA by Team",
y = "Average BAA")
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
labs(title = "Average BAA by Team",
y = "Average BAA")
theme(plot.title = element_text(hjust = 0.5)) +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
labs(title = "Average BAA by Team",
y = "Average BAA") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Average OPS',
title = 'Average OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75)) +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Mean OPS',
title = 'Mean OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75)) +
theme_minimal()
# histogram of BAAs by division
# projections %>%
#   ggplot(aes(x = AVG,
#              fill = Division)) +
#   geom_histogram(color = 'black') +
#   labs(title = 'Distribution of BAA Projection by Division',
#        x = 'BAA') +
#   theme(plot.title = element_text(hjust = 0.5),
#         legend.position = 'none') +
#   facet_wrap(~ Division) +
#   theme_minimal()
# error bar plot
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_baa), .desc = T) %>%
ggplot(aes(x = Team, y = avg_baa)) +
geom_errorbar(aes(ymin = lb_se_baa, ymax = ub_se_baa, colour = Division)) +
geom_point(aes(x = Team, y = avg_baa)) +
labs(title = "Mean BAA by Team",
y = "Mean BAA") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
coord_flip() +
theme_minimal()
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Mean OPS',
title = 'Mean OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.y= element_text(angle = 45, hjust = 1),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75))
# bar plot avg OPS
team_avg_projections %>%
mutate(Team = fct_reorder(Team, avg_ops), .desc = T) %>%
ggplot(aes(x = Team,
y = avg_ops,
fill = Division)) +
geom_col(color = 'black') +
labs(y = 'Mean OPS',
title = 'Mean OPS by Team') +
scale_y_continuous(n.breaks = 6) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = 'none') +
facet_wrap(~ Division, scales = 'free_y') +
#coord_flip(ylim = c(0.22,0.26)) +
coord_flip(ylim = c(0.6,0.75)) +
theme_minimal()
poll_data <- read.csv("~/Downloads/president_polls.csv")
poll_data <- read.csv("~/Downloads/president_polls.csv")
poll_data %>%
filter(!is.na(state))
library(tidyverse)
poll_data <- read.csv("~/Downloads/president_polls.csv")
poll_data %>%
filter(!is.na(state))
view(
poll_data %>%
filter(!is.na(state)))
table(poll_data$pollster)
library(tidyverse)
library(here)
library(fs)
library(httr2)
working_dir <- here::here("data", "2024", "2024-01-30")
groundhogs_all <- httr2::request("https://groundhog-day.com/api/v1/groundhogs/") |>
httr2::req_perform() |>
httr2::resp_body_json() |>
_$groundhogs |>
tibble::tibble(data = _) |>
tidyr::unnest_wider(data)
groundhogs <- groundhogs_all |>
dplyr::select(
-predictions,
-successor, # Only 1 groundhog has a successor, we'll mention it in the post.
-contact
) |>
janitor::clean_names() |>
dplyr::mutate(
# At least one has a stray comma at the end
coordinates = stringr::str_remove(coordinates, ",$")
) |>
tidyr::separate_wider_delim(
coordinates,
",",
names = c("latitude", "longitude")
) |>
dplyr::mutate(
# Correct types
latitude = as.double(latitude),
longitude = as.double(longitude),
is_groundhog = as.logical(is_groundhog),
active = as.logical(active)
)
install.packages("janitor")
library(tidyverse)
library(here)
library(fs)
library(httr2)
working_dir <- here::here("data", "2024", "2024-01-30")
groundhogs_all <- httr2::request("https://groundhog-day.com/api/v1/groundhogs/") |>
httr2::req_perform() |>
httr2::resp_body_json() |>
_$groundhogs |>
tibble::tibble(data = _) |>
tidyr::unnest_wider(data)
groundhogs <- groundhogs_all |>
dplyr::select(
-predictions,
-successor, # Only 1 groundhog has a successor, we'll mention it in the post.
-contact
) |>
janitor::clean_names() |>
dplyr::mutate(
# At least one has a stray comma at the end
coordinates = stringr::str_remove(coordinates, ",$")
) |>
tidyr::separate_wider_delim(
coordinates,
",",
names = c("latitude", "longitude")
) |>
dplyr::mutate(
# Correct types
latitude = as.double(latitude),
longitude = as.double(longitude),
is_groundhog = as.logical(is_groundhog),
active = as.logical(active)
)
predictions <- groundhogs_all |>
dplyr::select(id, predictions) |>
tidyr::unnest_longer(predictions) |>
tidyr::unnest_wider(predictions) |>
dplyr::mutate(shadow = as.logical(shadow))
readr::write_csv(
groundhogs,
fs::path(working_dir, "groundhogs.csv")
)
readr::write_csv(
fs::path("/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",   groundhogs)
)
readr::write_csv(
fs::path("~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",   groundhogs)
)
groundhogs
readr::write_csv(
fs::path("/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",   groundhogs)
)
predictions
readr::write_csv("/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",  groundhogs)
library(tidyverse)
library(here)
library(fs)
library(httr2)
working_dir <- here::here("data", "2024", "2024-01-30")
groundhogs_all <- httr2::request("https://groundhog-day.com/api/v1/groundhogs/") |>
httr2::req_perform() |>
httr2::resp_body_json() |>
_$groundhogs |>
tibble::tibble(data = _) |>
tidyr::unnest_wider(data)
groundhogs <- groundhogs_all |>
dplyr::select(
-predictions,
-successor, # Only 1 groundhog has a successor, we'll mention it in the post.
-contact
) |>
janitor::clean_names() |>
dplyr::mutate(
# At least one has a stray comma at the end
coordinates = stringr::str_remove(coordinates, ",$")
) |>
tidyr::separate_wider_delim(
coordinates,
",",
names = c("latitude", "longitude")
) |>
dplyr::mutate(
# Correct types
latitude = as.double(latitude),
longitude = as.double(longitude),
is_groundhog = as.logical(is_groundhog),
active = as.logical(active)
) %>%
as.data.frame()
predictions <- groundhogs_all |>
dplyr::select(id, predictions) |>
tidyr::unnest_longer(predictions) |>
tidyr::unnest_wider(predictions) |>
dplyr::mutate(shadow = as.logical(shadow))
readr::write_csv("/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",  groundhogs)
readr::write_csv("/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",  groundhogs)
readr::write_csv(file = "/~/Documents/SLU_Senior_Year/SP24/data_334/ds334blog/data/groundhogs.csv",  x = groundhogs)
readr::write_csv(file = "data/groundhogs.csv",  x = groundhogs)
predictions
groundhogs
predictions
table(groundhogs$id)
groundhogs
inner_join(predictions, groundhogs, by = c("id"= 'id'))
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id'))
library(maps)
state_df <- ggplot2::map_data("state")
joined_gh_data
joined_gh_data
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
filter(!is.na(shadow))
joined_gh_data %>%
ggplot(aes(x = longitude, y = latitude, group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_b()
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void()
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow))
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude)) +
geom_polygon(colour = "black", aes(fill = shadow))
ggplot(data = state_df,
mapping = aes(x = long, y = lat,
group = group)) +
geom_polygon()
state_df
state_df
joined_gh_data
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
filter(!is.na(shadow)) %>%
mutate(region = tolower(region))
joined_gh_data
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
filter(!is.na(shadow)) %>%
mutate(region = tolower(region)) %>%
left_join(state_df, by = c("region" = "region"))
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_b()
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
filter(!is.na(shadow)) %>%
mutate(region = tolower(region)) %>%
left_join(state_df, by = c("region" = "region"))
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_b()
joined_gh_data %>%
ggplot(aes(x = longitude,
y = latitude,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_d()
joined_gh_data
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_d()
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
#filter(!is.na(shadow)) %>%
mutate(region = tolower(region)) %>%
left_join(state_df, by = c("region" = "region"))
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_d()
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
#filter(!is.na(shadow)) %>%
mutate(region = tolower(region)) %>%
full_join(state_df, by = c("region" = "region"))
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_d()
joined_gh_data <-
inner_join(predictions, groundhogs, by = c("id"= 'id')) %>%
filter(!is.na(shadow)) %>%
mutate(region = tolower(region)) %>%
full_join(state_df, by = c("region" = "region"))
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_viridis_d()
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_discrete(type = ("springgreen", "red"))
?scale_fill_discrete
joined_gh_data %>%
ggplot(aes(x = long,
y = lat,
group = group)) +
geom_polygon(colour = "black", aes(fill = shadow)) +
coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
theme_void() +
scale_fill_discrete()
